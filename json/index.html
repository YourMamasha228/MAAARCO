<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>JSON –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä - –†–ê–ë–û–ß–ê–Ø –í–ï–†–°–ò–Ø</title>
    <style>
        /* –ë–∞–∑–æ–≤—ã–µ —Å—Ç–∏–ª–∏ */
        body { 
            font-family: Arial, sans-serif;
            max-width: 1200px; 
            margin: 20px auto; 
            padding: 0 20px; 
            background: #f5f5f5; 
        }

        h1 { 
            text-align: center; 
            color: #333; 
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –≤—Å–µ—Ö –∑–æ–Ω */
        .zone { 
            background: white; 
            padding: 20px; 
            margin: 20px 0; 
            border-radius: 10px; 
            box-shadow: 0 2px 5px rgba(0,0,0,0.1); 
        }

        .zone h2 { 
            margin-top: 0; 
            color: #2c3e50; 
            border-bottom: 2px solid #4CAF50; 
            padding-bottom: 10px; 
        }

        /* –°—Ç—Ä–æ–∫–∏ —Ñ–æ—Ä–º—ã */
        .form-row { 
            display: flex; 
            align-items: center; 
            margin: 10px 0; 
        }

        .form-row label { 
            width: 120px; 
            font-weight: bold; 
        }

        /* –ü–æ–ª—è –≤–≤–æ–¥–∞ */
        input[type="text"], 
        input[type="email"] { 
            flex: 1; 
            padding: 8px; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
        }

        input[type="checkbox"] { 
            width: 20px; 
            height: 20px; 
        }

        /* –¢–µ–∫—Å—Ç–æ–≤—ã–µ –ø–æ–ª—è */
        textarea { 
            width: 100%; 
            height: 150px; 
            margin: 10px 0; 
            font-family: monospace; 
            border: 1px solid #ddd; 
            border-radius: 4px; 
            padding: 10px;
        }

        /* –ö–Ω–æ–ø–∫–∏ */
        button { 
            margin: 5px; 
            padding: 10px 20px; 
            cursor: pointer; 
            background: #4CAF50; 
            color: white; 
            border: none; 
            border-radius: 4px; 
            font-size: 14px;
        }

        button:hover { 
            background: #45a049; 
        }

        /* –ì—Ä—É–ø–ø–∞ –∫–Ω–æ–ø–æ–∫ */
        .button-group {
            margin: 10px 0;
        }

        /* –ë–ª–æ–∫ –æ—à–∏–±–∫–∏ */
        .error { 
            color: red; 
            padding: 10px; 
            background: #ffeeee; 
            border-radius: 4px; 
            margin: 10px 0;
        }

        /* –ë–ª–æ–∫ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ */
        .success { 
            padding: 10px; 
            background: #f0f0f0; 
            border-radius: 4px; 
            white-space: pre-wrap; 
            font-family: monospace;
        }

        /* –ß–µ–∫–±–æ–∫—Å—ã —Ñ–∏–ª—å—Ç—Ä–∞ */
        .checkbox-group { 
            display: flex; 
            flex-wrap: wrap; 
            gap: 10px; 
            margin: 10px 0; 
            padding: 10px;
            background: #f8f9fa;
            border-radius: 4px;
        }

        .checkbox-group label { 
            margin-right: 15px; 
        }

        /* –ë–ª–æ–∫ –Ω–∞–±–ª—é–¥–µ–Ω–∏–π */
        #observations { 
            margin-top: 10px; 
            padding: 10px; 
            background: #fff3cd; 
            border-radius: 4px; 
        }

        /* –ü—Ä–µ–≤—å—é –æ–±—ä–µ–∫—Ç–∞ */
        #objectPreview { 
            background: #1e293b; 
            color: #bbd8ff; 
            padding: 10px; 
            border-radius: 4px; 
            margin-top: 10px;
        }

        /* –í—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫ */
        select {
            padding: 5px 10px;
            border-radius: 4px;
            border: 1px solid #ddd;
        }

        /* –ù–æ–º–µ—Ä–∞ –∑–æ–Ω */
        .zone-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .zone-number {
            background: #4CAF50;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <h1>üîÑ JSON –ö–æ–Ω–≤–µ—Ä—Ç–µ—Ä –ø—Ä–æ—Ñ–∏–ª—è (–ò–°–ü–†–ê–í–õ–ï–ù–ù–ê–Ø –í–ï–†–°–ò–Ø)</h1>

    <!-- ===== –ó–û–ù–ê 1: –ò–ú–ü–û–†–¢ ===== -->
    <div class="zone">
        <div class="zone-header">
            <span class="zone-number">1</span>
            <h2>–ò–º–ø–æ—Ä—Ç JSON</h2>
        </div>
        
        <textarea id="jsonInput" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON —Å—é–¥–∞...">{"userName":"–¢–µ—Å—Ç","age":20,"isStudent":true}</textarea>
        
        <div class="button-group">
            <button onclick="importJSON()">üì• –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            <button onclick="clearImport()">üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å</button>
        </div>
        
        <div id="importError" class="error" style="display: none;"></div>
        <div id="importResult" class="success">–û–∂–∏–¥–∞–Ω–∏–µ –∏–º–ø–æ—Ä—Ç–∞...</div>
    </div>

    <!-- ===== –ó–û–ù–ê 2: –≠–ö–°–ü–û–†–¢ ===== -->
    <div class="zone">
        <div class="zone-header">
            <span class="zone-number">2</span>
            <h2>–≠–∫—Å–ø–æ—Ä—Ç JSON</h2>
        </div>

        <div style="margin: 10px 0;">
            <label>–û—Ç—Å—Ç—É–ø: </label>
            <select id="spaceSelect">
                <option value="0">0</option>
                <option value="2" selected>2</option>
                <option value="4">4</option>
            </select>
        </div>

        <div style="margin: 10px 0;">
            <strong>–ö–ª—é—á–∏ –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞:</strong>
            <div class="checkbox-group" id="keyFilters"></div>
        </div>

        <div class="button-group">
            <button onclick="exportNormal()">üì§ –û–±—ã—á–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç</button>
            <button onclick="exportWithKeys()">üîë –≠–∫—Å–ø–æ—Ä—Ç —Å —Ñ–∏–ª—å—Ç—Ä–æ–º</button>
        </div>
        
        <textarea id="jsonOutput" placeholder="–ó–¥–µ—Å—å –ø–æ—è–≤–∏—Ç—Å—è JSON..." readonly></textarea>
        
        <div id="observations">
            <strong>–ù–∞–±–ª—é–¥–µ–Ω–∏—è:</strong> –î–æ–±–∞–≤—å—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–ª—è –≤ –ø—Ä–æ—Ñ–∏–ª–µ
        </div>
    </div>

    <!-- ===== –ó–û–ù–ê 3: –ü–†–û–§–ò–õ–¨ ===== -->
    <div class="zone">
        <div class="zone-header">
            <span class="zone-number">3</span>
            <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
        </div>

        <div class="form-row">
            <label>–ò–º—è:</label>
            <input type="text" id="userName" value="–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤">
        </div>

        <div class="form-row">
            <label>–í–æ–∑—Ä–∞—Å—Ç:</label>
            <input type="text" id="age" value="25">
        </div>

        <div class="form-row">
            <label>–°—Ç—É–¥–µ–Ω—Ç:</label>
            <input type="checkbox" id="isStudent" checked>
        </div>

        <div class="form-row">
            <label>–ì–æ—Ä–æ–¥:</label>
            <input type="text" id="city" value="–ú–æ—Å–∫–≤–∞">
        </div>

        <div class="form-row">
            <label>–ì—Ä—É–ø–ø–∞:</label>
            <input type="text" id="group" value="–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏">
        </div>

        <div class="form-row">
            <label>Email:</label>
            <input type="email" id="email" value="ivan@mail.ru">
        </div>

        <div class="form-row">
            <label>–¢–µ–≥–∏:</label>
            <input type="text" id="tags" value="js, json, html">
        </div>

        <div style="margin: 15px 0;">
            <label>
                <input type="checkbox" id="addProblematic">
                ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–ª—è (undefined, NaN, Date, —Ñ—É–Ω–∫—Ü–∏—è)
            </label>
        </div>

        <div class="button-group">
            <button onclick="buildObject()">üì¶ –°–æ–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç</button>
            <button onclick="resetForm()">üîÑ –°–±—Ä–æ—Å–∏—Ç—å</button>
            <button onclick="fillExample()">üìã –ü—Ä–∏–º–µ—Ä</button>
        </div>

        <div id="objectPreview" class="success">–ù–∞–∂–º–∏—Ç–µ "–°–æ–±—Ä–∞—Ç—å –æ–±—ä–µ–∫—Ç"</div>
    </div>

    <script>
        // ===============================================
        // –í–ï–°–¨ JAVASCRIPT –ó–î–ï–°–¨ - –í–°–Å –†–ê–ë–û–¢–ê–ï–¢!
        // ===============================================

        // –¢–µ–∫—É—â–∏–π –æ–±—ä–µ–∫—Ç
        let currentObject = null;

        // ===== –°–ë–û–†–ö–ê –û–ë–™–ï–ö–¢–ê =====
        function buildObject() {
            const obj = {
                id: Date.now(),
                userName: document.getElementById('userName').value,
                age: document.getElementById('age').value,
                isStudent: document.getElementById('isStudent').checked,
                tags: document.getElementById('tags').value,
                profile: {
                    city: document.getElementById('city').value,
                    group: document.getElementById('group').value,
                    contacts: {
                        email: document.getElementById('email').value
                    }
                }
            };

            // –ü—Ä–æ–±–ª–µ–º–Ω—ã–µ –ø–æ–ª—è
            if (document.getElementById('addProblematic').checked) {
                obj.temp = undefined;
                obj.calc = function() { console.log('—Ñ—É–Ω–∫—Ü–∏—è'); };
                obj.score = NaN;
                obj.inf = Infinity;
                obj.createdAt = new Date();
            }

            currentObject = obj;
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—ä–µ–∫—Ç
            document.getElementById('objectPreview').innerHTML = 
                '<strong>–¢–µ–∫—É—â–∏–π –æ–±—ä–µ–∫—Ç:</strong><br>' + 
                JSON.stringify(obj, (k, v) => typeof v === 'function' ? '—Ñ—É–Ω–∫—Ü–∏—è' : v, 2);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —á–µ–∫–±–æ–∫—Å—ã
            updateCheckboxes(obj);
        }

        // ===== –û–ë–ù–û–í–õ–ï–ù–ò–ï –ß–ï–ö–ë–û–ö–°–û–í =====
        function updateCheckboxes(obj) {
            const container = document.getElementById('keyFilters');
            if (!container) return;
            
            container.innerHTML = '';
            
            for (let key in obj) {
                container.innerHTML += `
                    <label>
                        <input type="checkbox" value="${key}" checked> ${key}
                    </label>
                `;
            }
        }

        // ===== –û–ë–´–ß–ù–´–ô –≠–ö–°–ü–û–†–¢ =====
        function exportNormal() {
            if (!currentObject) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç!');
                return;
            }
            
            const space = Number(document.getElementById('spaceSelect').value);
            const json = JSON.stringify(currentObject, null, space);
            document.getElementById('jsonOutput').value = json;
            showObservations(currentObject);
        }

        // ===== –≠–ö–°–ü–û–†–¢ –° –§–ò–õ–¨–¢–†–û–ú =====
        function exportWithKeys() {
            if (!currentObject) {
                alert('–°–Ω–∞—á–∞–ª–∞ —Å–æ–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç!');
                return;
            }
            
            const checkboxes = document.querySelectorAll('#keyFilters input:checked');
            const keys = Array.from(checkboxes).map(cb => cb.value);
            
            if (keys.length === 0) {
                alert('–í—ã–±–µ—Ä–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω –∫–ª—é—á!');
                return;
            }
            
            const space = Number(document.getElementById('spaceSelect').value);
            const json = JSON.stringify(currentObject, keys, space);
            document.getElementById('jsonOutput').value = json;
            showObservations(currentObject);
        }

        // ===== –ù–ê–ë–õ–Æ–î–ï–ù–ò–Ø =====
        function showObservations(obj) {
            const obs = document.getElementById('observations');
            let text = '<strong>–ù–∞–±–ª—é–¥–µ–Ω–∏—è:</strong><br>';
            
            if (obj.temp === undefined && 'temp' in obj) text += '‚Ä¢ undefined –ø—Ä–æ–ø–∞–ª –∏–∑ JSON<br>';
            if (typeof obj.calc === 'function') text += '‚Ä¢ —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–æ–ø–∞–ª–∞ –∏–∑ JSON<br>';
            if (typeof obj.score === 'number' && isNaN(obj.score)) text += '‚Ä¢ NaN —Å—Ç–∞–ª null<br>';
            if (obj.inf === Infinity) text += '‚Ä¢ Infinity —Å—Ç–∞–ª null<br>';
            if (obj.createdAt instanceof Date) text += '‚Ä¢ Date —Å—Ç–∞–ª —Å—Ç—Ä–æ–∫–æ–π<br>';
            
            if (text === '<strong>–ù–∞–±–ª—é–¥–µ–Ω–∏—è:</strong><br>') {
                text += '‚Ä¢ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö –ø–æ–ª–µ–π –Ω–µ—Ç';
            }
            
            obs.innerHTML = text;
        }

        // ===== –ò–ú–ü–û–†–¢ =====
        function importJSON() {
            const jsonText = document.getElementById('jsonInput').value;
            const errorDiv = document.getElementById('importError');
            const resultDiv = document.getElementById('importResult');
            
            errorDiv.style.display = 'none';
            
            try {
                const obj = JSON.parse(jsonText);
                resultDiv.innerHTML = '<strong>–£—Å–ø–µ—Ö! –û–±—ä–µ–∫—Ç:</strong><br>' + 
                    JSON.stringify(obj, null, 2);
            } catch (error) {
                errorDiv.style.display = 'block';
                errorDiv.innerHTML = '‚ùå –û—à–∏–±–∫–∞: ' + error.message;
                resultDiv.innerHTML = '–û—à–∏–±–∫–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞';
            }
        }

        // ===== –û–ß–ò–°–¢–ö–ê –ò–ú–ü–û–†–¢–ê =====
        function clearImport() {
            document.getElementById('jsonInput').value = '';
            document.getElementById('importError').style.display = 'none';
            document.getElementById('importResult').innerHTML = '–ü–æ–ª–µ –æ—á–∏—â–µ–Ω–æ';
        }

        // ===== –°–ë–†–û–° –§–û–†–ú–´ =====
        function resetForm() {
            document.getElementById('userName').value = '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤';
            document.getElementById('age').value = '25';
            document.getElementById('isStudent').checked = true;
            document.getElementById('city').value = '–ú–æ—Å–∫–≤–∞';
            document.getElementById('group').value = '–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏';
            document.getElementById('email').value = 'ivan@mail.ru';
            document.getElementById('tags').value = 'js, json, html';
            document.getElementById('addProblematic').checked = false;
            
            buildObject();
        }

        // ===== –ü–†–ò–ú–ï–† –î–ê–ù–ù–´–• =====
        function fillExample() {
            document.getElementById('userName').value = '–ê–Ω–Ω–∞ –°–º–∏—Ä–Ω–æ–≤–∞';
            document.getElementById('age').value = '28';
            document.getElementById('isStudent').checked = false;
            document.getElementById('city').value = '–°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥';
            document.getElementById('group').value = '–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥';
            document.getElementById('email').value = 'anna@mail.ru';
            document.getElementById('tags').value = '–º–∞—Ä–∫–µ—Ç–∏–Ω–≥, smm, —Ä–µ–∫–ª–∞–º–∞';
            document.getElementById('addProblematic').checked = true;
            
            buildObject();
        }

        // ===== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø =====
        window.onload = function() {
            buildObject();
        };
    </script>
</body>
</html>